{"is_source_file": true, "format": "JavaScript", "description": "This file contains the configuration and operations for a JSON file-based database, including functions for atomic operations, reading and writing collections, and initializing the database.", "external_files": ["./logger.js"], "external_methods": ["logger.error", "logger.info"], "published": ["connectDB", "atomicOperation", "readCollection", "writeCollection", "DB_CONFIG"], "classes": [], "methods": [{"name": "connectDB", "description": "Connects to the JSON file database, initializes the database if needed."}, {"name": "atomicOperation", "description": "Performs an atomic operation on a specified collection with retries."}, {"name": "readCollection", "description": "Reads data from a specified collection file and parses it as JSON."}, {"name": "writeCollection", "description": "Writes data to a specified collection file after creating a temporary file."}, {"name": "initializeDB", "description": "Initializes the database by creating the data directory and collections if they do not exist."}, {"name": "acquireLock", "description": "Attempts to acquire a lock file for atomic operations."}, {"name": "releaseLock", "description": "Releases the lock file once an operation is completed."}], "calls": ["fs.writeFile", "fs.unlink", "fs.access", "fs.mkdir", "fs.rename", "fs.readFile"], "search-terms": ["JSON database", "file operations", "atomic writes", "data consistency"], "state": 2, "file_id": 13, "knowledge_revision": 260, "git_revision": "a99de39b41f651ec5ec42496775bb2e93b4b6608", "revision_history": [{"28": ""}, {"43": ""}, {"63": "8296b8630f75858aa9ee4b404a93a5282a92129b"}, {"64": "8296b8630f75858aa9ee4b404a93a5282a92129b"}, {"130": "906589ebe3993184b636ddfb8e96afa429316a90"}, {"131": "12d0961a5dab013b5fd7b91d1e0c74e95b56acde"}, {"132": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"133": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"134": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"135": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"136": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"137": "cab7f21393f5b9e8c1ff8b931dc40dea7b8c131c"}, {"138": "de70eaec04521871d60c0576585e126292ef8283"}, {"139": "de70eaec04521871d60c0576585e126292ef8283"}, {"140": "de70eaec04521871d60c0576585e126292ef8283"}, {"141": "de70eaec04521871d60c0576585e126292ef8283"}, {"145": "afbd7553b7f3b7c21c020f3bb8eda5044d448870"}, {"146": "afbd7553b7f3b7c21c020f3bb8eda5044d448870"}, {"147": "afbd7553b7f3b7c21c020f3bb8eda5044d448870"}, {"148": "067c6a9fce47c8ca6291c30b0244765392ace3b8"}, {"150": "067c6a9fce47c8ca6291c30b0244765392ace3b8"}, {"260": "a99de39b41f651ec5ec42496775bb2e93b4b6608"}], "ctags": [{"_type": "tag", "name": "DB_CONFIG", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const DB_CONFIG = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "acquireLock", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const acquireLock = async (lockFile) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "atomicOperation", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const atomicOperation = async (collection, operation) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "collections", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  collections: {$/", "language": "JavaScript", "kind": "class", "scope": "DB_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "connectDB", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const connectDB = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^    const data = await fs.readFile(filePath, 'utf8');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dataDir", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  dataDir: path.join(process.cwd(), 'data'),$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "filePath", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^      const filePath = path.join(DB_CONFIG.dataDir, collection);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "filePath", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  const filePath = path.join(DB_CONFIG.dataDir, DB_CONFIG.collections[collection]);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "indexes", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^    indexes: 'indexes.json'$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG.collections", "scopeKind": "class"}, {"_type": "tag", "name": "initializeDB", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const initializeDB = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "lockFile", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  const lockFile = `${filePath}.lock`;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "lockTimeout", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  lockTimeout: 5000, \\/\\/ 5 seconds timeout for locks$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "maxRetries", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  maxRetries: 3,    \\/\\/ Maximum retries for atomic operations$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "readCollection", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const readCollection = async (filePath) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "releaseLock", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const releaseLock = async (lockFile) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^          const result = await operation(filePath);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "retries", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  let retries = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "retryDelay", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  retryDelay: 100   \\/\\/ Initial retry delay in milliseconds$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "sessions", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^    sessions: 'sessions.json',$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG.collections", "scopeKind": "class"}, {"_type": "tag", "name": "tempFile", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^  const tempFile = `${filePath}.tmp`;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "users", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^    users: 'users.json',$/", "language": "JavaScript", "kind": "property", "scope": "DB_CONFIG.collections", "scopeKind": "class"}, {"_type": "tag", "name": "writeCollection", "path": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "pattern": "/^const writeCollection = async (filePath, data) => {$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/order-processing/authentication_component/src/config/database.js", "hash": "a9560f075fc79fafa552d860c59df1fb", "format-version": 4, "code-base-name": "default", "fields": [{"name": "dataDir: path.join(process.cwd(), 'data'),", "scope": "DB_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "indexes: 'indexes.json'", "scope": "DB_CONFIG.collections", "scopeKind": "class", "description": "unavailable"}, {"name": "lockTimeout: 5000, \\/\\/ 5 seconds timeout for locks", "scope": "DB_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "maxRetries: 3,    \\/\\/ Maximum retries for atomic operations", "scope": "DB_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "let retries = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "retryDelay: 100   \\/\\/ Initial retry delay in milliseconds", "scope": "DB_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "sessions: 'sessions.json',", "scope": "DB_CONFIG.collections", "scopeKind": "class", "description": "unavailable"}, {"name": "users: 'users.json',", "scope": "DB_CONFIG.collections", "scopeKind": "class", "description": "unavailable"}]}