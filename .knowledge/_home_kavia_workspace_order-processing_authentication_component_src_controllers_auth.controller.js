{"is_source_file": true, "format": "JavaScript", "description": "This file implements the authentication controller for user registration, login, email verification, password reset request, and password reset functionalities.", "external_files": ["../config/jwt.js", "../models/user.model.js", "../config/logger.js"], "external_methods": ["User.findOne", "User.create", "User.findByIdAndUpdate", "logger.logSecurityEvent", "logger.error"], "published": ["register", "login", "verifyEmail", "requestPasswordReset", "resetPassword"], "classes": [], "methods": [{"name": "register", "description": "Handles user registration including checks for existing users and JWT token generation."}, {"name": "login", "description": "Handles user login, validates credentials, checks account status, and generates JWT token."}, {"name": "verifyEmail", "description": "Handles email verification for users using a verification token."}, {"name": "requestPasswordReset", "description": "Handles requests for password reset, generates a reset token, and sends a response."}, {"name": "resetPassword", "description": "Handles password reset using a valid reset token and updates the user's password."}], "calls": ["User.findOne", "User.create", "User.isLocked", "user.comparePassword", "User.findByIdAndUpdate", "User.save"], "search-terms": ["authentication", "user registration", "user login", "email verification", "password reset"], "state": 2, "file_id": 30, "knowledge_revision": 111, "git_revision": "", "revision_history": [{"105": ""}, {"111": ""}], "ctags": [{"_type": "tag", "name": "existingUser", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const existingUser = await User.findOne({ email });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isMatch", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const isMatch = await user.comparePassword(password);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "login", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^const login = async (req, res) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "register", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^const register = async (req, res) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "requestPasswordReset", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^const requestPasswordReset = async (req, res) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resetPassword", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^const resetPassword = async (req, res) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resetToken", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const resetToken = Math.random().toString(36).substring(2, 15);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const token = generateToken({ userId: user._id });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const user = await User.create({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const user = await User.findOne({ email });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const user = await User.findOne({ verificationToken: token });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^    const user = await User.findOne({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "verifyEmail", "path": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "pattern": "/^const verifyEmail = async (req, res) => {$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/order-processing/authentication_component/src/controllers/auth.controller.js", "hash": "d412e66317d263d65eca967b5aa500ae", "format-version": 4, "code-base-name": "default"}